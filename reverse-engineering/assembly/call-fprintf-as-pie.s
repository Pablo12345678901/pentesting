	# This program uses 'fprintf' to output a message to user.
	# It was written as a position-independent executable.
	.globl main

#------------------------------------------------------------------------------
	
	.section .rodata

message_hello_world:
	.ascii "\nHello, world !\n\0"

#------------------------------------------------------------------------------
	
	.section .text
	
main:
	enter $0, $0

	# Load the symbol address 'stdout'
	movq stdout@GOTPCREL(%rip), %rdi
	# Load its value
	movq (%rdi), %rdi
	
	leaq message_hello_world(%rip), %rsi

	# No floating-point argument for variadic function.
	movq $0, %rax
	call fprintf@plt

	# Set '0' as main return code.
	xor %rax, %rax

	leave
	ret

#------------------------------------------------------------------------------

	# Set non-executable stack ("") that contains program data "@progbits"
	.section .note.GNU-stack, "", @progbits
