# This file has to be linked with 'person-with-additional-fields-data.s' and will return the maximum value of the specific field choosed below (NEED to be (un)commented)).
	
	.globl _start
	.section .text
_start:
	# Load address of first record
	leaq people, %rbx

	# Get record count to loop on it.
	movq number_of_people, %rcx

	# Set default biggest value found to the minimum existing in the range 0-255.
	movq $0, %rdi

	# Exit if there is no record
	cmpq $0, %rcx
	je end_of_program

main_loop:
	# Reminder : %rbx is the pointer to the struct.
	# Depending on the (un)commented line(s), the maximum of the specific field will be returned.
	# The first field offset is NAME_OFFSET and it has no sence to check for maximum values on string so it is not proposed here as a field to be returned.
	#movq WEIGTH_OFFSET(%rbx), %rax # returns : 250
	#movq LAST_TWO_DIGITS_PHONE_NUMBER_OFFSET(%rbx), %rax # returns : 96
	#movq SHOE_OFFSET(%rbx), %rax # returns : 12
	#movq HAIR_OFFSET(%rbx), %rax # returns : 5
	movq FACEBOOK_FRIENDS_OFFSET(%rbx), %rax # returns : 56
	#movq HEIGTH_OFFSET(%rbx), %rax # returns : 74
	#movq AGE_OFFSET(%rbx), %rax # returns : 65

	# If it is less or equal than current maximum, get to next value - if any.
	cmpq %rdi, %rax
	jbe end_loop
	
	# Else adapt the current maximum.
	movq %rax, %rdi

end_loop:
	# Get the address of next person by adding the size of one person to the address of the struct.
	addq $PERSON_RECORD_SIZE, %rbx
	loopq main_loop
	
end_of_program:
	# Exit syscall
	movq $60, %rax
	syscall
